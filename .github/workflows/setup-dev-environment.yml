name: Setup dev environment

on:
    workflow_dispatch:
     inputs:
        dev_branch:
         description: 'name of the developer branch'
         required: true
         default: DEV-US_XXX_Y
        work_account:
            description: 'work account of the developer'
            required: true
            default: makerb@jovadkere5.onmicrosoft.com

jobs:
  build:
   runs-on: windows-latest
   steps:
     - uses: actions/checkout@v2
       with:
        token: ${{ secrets.GITHUB_TOKEN }}

     - name: Install Power Platform Tools
       uses: microsoft/powerplatform-actions/actions-install@v1

     - name: Install Pac CLI
       run: |
        echo "Installing Pac CLI"
        dotnet tool install --global Microsoft.PowerApps.CLI.Tool
     - name: Create developer branch
       shell: bash
       run: |
        email="${{ github.event.inputs.work_account }}"
        username="${email%%@*}"
        git config user.name $username
        git config user.email $email
        #creating the branch under "dev" folder
        newbranch=dev/${{ github.event.inputs.dev_branch }}
        git checkout -b $newbranch
        git push origin $newbranch
      
          